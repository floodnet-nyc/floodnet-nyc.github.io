I"
G<h1 id="real-time-flood-depth-data-quality-control">Real-time Flood Depth Data Quality Control</h1>

<h2 id="10-general">1.0 General</h2>

<h3 id="11-background">1.1 Background</h3>

<p><a href="floodnet.nyc">FloodNet</a> is a cooperative of communities, researchers, New York City governament agencies working to better understand the frequency, severity, and impacts of flooding in New York City. This project uses advanced IoT flood sensors to measure Real-time Flood Depth Data (FDD) on a city-wide scale. These sensors use <a href="https://www.maxbotix.com/ultrasonic_sensors/mb7389.htm">Industrial grade Ultrasonic Ranging sensors</a> to calculate the depth data.</p>

<h3 id="12-purpose">1.2 Purpose</h3>

<p>The purpose of this document is to explain the Quality Control (QC) of Real-time Flood Depth Data (FDD) at FloodNet. This manual presents series of QC procedures for FDD with real-time data as the focus. These QC procedures are written specifically to the Real-time FDD collected from the sensors based on Ultrasonic Range-finding Technology.</p>

<p>FDD observations are collected in the streets and canals in an urban setting in real-time. The Data flow pipeline and QC tests in this document are documented and classified with the help of following references:</p>

<ol>
  <li>
    <p><a href="https://doi.org/10.25923/vpsx-dc82">U.S. Integrated Ocean Observing System, 2021 Manual for Real-Time Quality Control of Water Level Data Version 2.1</a></p>
  </li>
  <li>
    <p><a href="ftp://ftp.library.noaa.gov/noaa_documents.lib/NWS/NWS_TSP_88-21-R2.pdf">NWS Techniques Specification Package (TSP) 88-21-R2 (1994)</a></p>
  </li>
</ol>

<h2 id="20-considerationslimitations">2.0 Considerations/Limitations</h2>

<p>This section details the important considerations and limitations of the Flood Depth Data quality.</p>

<h2 id="21-ground-truth-validation-of-real-time-flood-depth-data">2.1 Ground truth Validation of Real-time Flood Depth Data</h2>

<p>To manually validate the Real-time Flood Depth Data, the FloodNet researchers have conducted Manual Validation Experiment during the event of a flood on the July 23 at 8:30pm in {location} and compared with the sensor data. The following figure shows the comparision of manual depth captured vs Flood-Depth Data processed from the Data-pipeline. The results verify the validation of the Flood Depth Data captured by this Real-time Flood Monitoring System.</p>

<figure>
  <img src="/assets/images/manual-validation-plot.png" alt="validation plot" />
</figure>

<p><img src="/assets/images/floodnet-researchers-in-action.jpg" width="400" /></p>

<h3 id="22-sensor-deployment-considerations">2.2 Sensor Deployment Considerations</h3>

<h4 id="221-error-in-pole-mount-angles">2.2.1 Error in Pole Mount Angles</h4>

<p>Error in Light pole angles, street sign post angles</p>

<h4 id="222-location-and-surface">2.2.2 Location and Surface</h4>

<h4 id="223-obstacles">2.2.3 Obstacles</h4>

<p>Weeds, dogs, humans, animals</p>

<h3 id="23-hardware-limitations">2.3 Hardware Limitations</h3>

<h4 id="231-accuracy-of-ultrasonic-sensor">2.3.1 Accuracy of Ultrasonic Sensor</h4>

<h4 id="232-noise-floor-of-ultrasonic-sensor">2.3.2 Noise Floor of Ultrasonic Sensor</h4>

<h4 id="233-seasonal-and-temperature-drift">2.3.3 Seasonal and Temperature Drift</h4>

<h4 id="234-influence-on-ultrasonic-raw-measurements-by-external-factors">2.3.4 Influence on Ultrasonic Raw measurements by external factors</h4>

<h3 id="24-other-important-considerations">2.4 Other Important Considerations</h3>

<p>In addition to the data quality mentioned in the manual, Quality Assurance Process (QAP) performed on sensor during assembly/production is critical to data quality. All personnel performing sensor build must follow the QAP procedure and shall comply Hardware QC checklist during the assembly/production process prior to the deployment.</p>

<p>All sensors and measurements contains errors that are determined by hardware quality, calibration accuracy, modes of operation, and data processing and pipeline techniques. All these considereations are quantified and explained in the section 4.2 Flood Sensor QC Test description.</p>

<h2 id="30-flood-depth-data-flow-pipeline">3.0 Flood Depth Data Flow Pipeline</h2>

<h3 id="31-data-flow-pipeline-overview">3.1 Data Flow Pipeline Overview</h3>

<p>The following figure shows the overview of the Data Flow Pipeline:</p>

<p><img src="/assets/images/data-pipeline-overview.png" alt="datapipeline-overview" /></p>

<p>The Flood Sensors transmit the raw data packets over LoRaWAN. These packets are forwarded to a The Things Network (TTN) application via LoRa Gateway. This data is further flows from the TTN into an open-source tools hosted on NYU servers. This combination of docker containers is running a load-balanced web server (NGINX), certificate authority (LetsEncrypt), data routing layer (NodeRed), a database (InfluxDB), and a dashboard platform (Grafana).</p>

<p>When the raw data packets transmitted by the sensors from the field reach the Node-RED, Pre-Production (Laboratory), Post-Production (On-Site), and Real-Time (On-Site) testing stages are implemented.</p>

<p>Raw as well as tested data is stored in the InfluxDB database. From there, Grafana handles all the visualization and alerting through its intuitive dashboarding platform.</p>

<h3 id="32-data-flow-pipeline-description">3.2 Data Flow Pipeline Description</h3>

<h4 id="321-flood-sensors">3.2.1 Flood Sensors</h4>

<h4 id="322-lorawan">3.2.2 LoRaWAN</h4>

<h4 id="323-lora-gateway">3.2.3 LoRa Gateway</h4>

<h4 id="324-ttn">3.2.4 TTN</h4>

<h4 id="325-nginx">3.2.5 NGINX</h4>

<h4 id="326-nodered">3.2.6 NodeRED</h4>

<h4 id="327-influxdb">3.2.7 InfluxDB</h4>

<h4 id="328-grafana">3.2.8 Grafana</h4>

<h2 id="40-quality-control">4.0 Quality Control</h2>

<h3 id="41-flood-depth-data-qc-test-hierarchy">4.1 Flood Depth Data QC Test Hierarchy</h3>

<p>The quality of the Flood Depth Data captured by the sensors is tested during three different categories:</p>
<ol>
  <li>
    <p><strong>Pre-Production Testing (Laboratory) - Stage 1:</strong> 
 This phase of testing is the initial validation of sensor accuracy and calibration. This is carried out in controlled laboratory conditions where the most highly accurate measurements are possible. These controlled conditions include - testing at room temperature, no external factors such as sunlight, noise, wind, and humidity, obstacles, and interference.</p>
  </li>
  <li>
    <p><strong>Post-Production Testing (On-Site) - Stage 2:</strong> 
  After the sensor installation on-site, the sensor is calibrated during the night times over a period of {fill-me-in} as {so and so- reason}. This is the reference point or the baseline which lies on the street-level. Further depending on the sensor mounting location, the possible scenarios are:</p>

    <ul>
      <li>Sensor mounted on Street-Sign Post (fig a): Sidewalk is the baseline</li>
      <li>Sensor mounted on base of the Light Pole (fig b): Sidewalk is the baseline</li>
      <li>Sensor mounted on top of the Light Pole (fig c): Street level is the baseline</li>
    </ul>
  </li>
  <li>
    <p><strong>Real-time Testing (On-Site) - Stage 3:</strong> 
  Once the baseline of the sensor has been calculated, the data is passed through the full data flow pipeline for QC. This processed and QC tested data is source for the dashboard.</p>
  </li>
</ol>

<p>The following table lists the tests in the ordere of implemetation and hierarchy:</p>

<style type="text/css">.tg-sort-header::-moz-selection{background:0 0}.tg-sort-header::selection{background:0 0}.tg-sort-header{cursor:pointer}.tg-sort-header:after{content:'';float:right;margin-top:7px;border-width:0 5px 5px;border-style:solid;border-color:#404040 transparent;visibility:hidden}.tg-sort-header:hover:after{visibility:visible}.tg-sort-asc:after,.tg-sort-asc:hover:after,.tg-sort-desc:after{visibility:visible;opacity:.4}.tg-sort-desc:after{border-bottom:none;border-width:5px 5px 0}</style>
<table id="tg-Vw41J" style="border-collapse:collapse;border-spacing:0" class="tg"><tbody><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;font-weight:bold;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Category</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;font-weight:bold;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">QC Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;font-weight:bold;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Stage</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal" rowspan="2">Pre-Production Testing (Laboratory)</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Calibration Test </td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">1</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Accuracy Percentage Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">1</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal">Post-Production Testing (On-Site)</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">On-Site Calibration Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">2</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal" rowspan="7">Real-time Testing (On-Site)</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Message Syntax Check</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Gross Range Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Spike Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Noise Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Rate of change test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Flat Line Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr><tr><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">Neighbor Sensor Test</td><td style="border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">3</td></tr></tbody></table>
<script charset="utf-8">var TGSort=window.TGSort||function(n){"use strict";function r(n){return n?n.length:0}function t(n,t,e,o=0){for(e=r(n);o<e;++o)t(n[o],o)}function e(n){return n.split("").reverse().join("")}function o(n){var e=n[0];return t(n,function(n){for(;!n.startsWith(e);)e=e.substring(0,r(e)-1)}),r(e)}function u(n,r,e=[]){return t(n,function(n){r(n)&&e.push(n)}),e}var a=parseFloat;function i(n,r){return function(t){var e="";return t.replace(n,function(n,t,o){return e=t.replace(r,"")+"."+(o||"").substring(1)}),a(e)}}var s=i(/^(?:\s*)([+-]?(?:\d+)(?:,\d{3})*)(\.\d*)?$/g,/,/g),c=i(/^(?:\s*)([+-]?(?:\d+)(?:\.\d{3})*)(,\d*)?$/g,/\./g);function f(n){var t=a(n);return!isNaN(t)&&r(""+t)+1>=r(n)?t:NaN}function d(n){var e=[],o=n;return t([f,s,c],function(u){var a=[],i=[];t(n,function(n,r){r=u(n),a.push(r),r||i.push(n)}),r(i)<r(o)&&(o=i,e=a)}),r(u(o,function(n){return n==o[0]}))==r(o)?e:[]}function v(n){if("TABLE"==n.nodeName){for(var a=function(r){var e,o,u=[],a=[];return function n(r,e){e(r),t(r.childNodes,function(r){n(r,e)})}(n,function(n){"TR"==(o=n.nodeName)?(e=[],u.push(e),a.push(n)):"TD"!=o&&"TH"!=o||e.push(n)}),[u,a]}(),i=a[0],s=a[1],c=r(i),f=c>1&&r(i[0])<r(i[1])?1:0,v=f+1,p=i[f],h=r(p),l=[],g=[],N=[],m=v;m<c;++m){for(var T=0;T<h;++T){r(g)<h&&g.push([]);var C=i[m][T],L=C.textContent||C.innerText||"";g[T].push(L.trim())}N.push(m-v)}t(p,function(n,t){l[t]=0;var a=n.classList;a.add("tg-sort-header"),n.addEventListener("click",function(){var n=l[t];!function(){for(var n=0;n<h;++n){var r=p[n].classList;r.remove("tg-sort-asc"),r.remove("tg-sort-desc"),l[n]=0}}(),(n=1==n?-1:+!n)&&a.add(n>0?"tg-sort-asc":"tg-sort-desc"),l[t]=n;var i,f=g[t],m=function(r,t){return n*f[r].localeCompare(f[t])||n*(r-t)},T=function(n){var t=d(n);if(!r(t)){var u=o(n),a=o(n.map(e));t=d(n.map(function(n){return n.substring(u,r(n)-a)}))}return t}(f);(r(T)||r(T=r(u(i=f.map(Date.parse),isNaN))?[]:i))&&(m=function(r,t){var e=T[r],o=T[t],u=isNaN(e),a=isNaN(o);return u&&a?0:u?-n:a?n:e>o?n:e<o?-n:n*(r-t)});var C,L=N.slice();L.sort(m);for(var E=v;E<c;++E)(C=s[E].parentNode).removeChild(s[E]);for(E=v;E<c;++E)C.appendChild(s[v+L[E-v]])})})}}n.addEventListener("DOMContentLoaded",function(){for(var t=n.getElementsByClassName("tg"),e=0;e<r(t);++e)try{v(t[e])}catch(n){}})}(document)</script>

<h3 id="42-flood-sensors-qc-test-descriptions">4.2 Flood Sensors QC Test Descriptions</h3>

<h4 id="421-pre-production-testing-laboratory">4.2.1 Pre-Production testing (Laboratory)</h4>

<h5 id="noise-floor-test">Noise floor Test</h5>

<h5 id="accuracy-percentage-check">Accuracy Percentage Check</h5>

<h5 id="calibration-test">Calibration Test</h5>

<h4 id="422-post-production-testing-on-site">4.2.2 Post-Production testing (On-Site)</h4>

<h5 id="baseline-calibration-test">Baseline Calibration Test</h5>

<h4 id="423-real-time-testing-on-site">4.2.3 Real-time Testing (On-Site)</h4>

<h5 id="message-syntax-check">Message Syntax Check</h5>

<h5 id="gross-range-check">Gross Range Check</h5>

<h5 id="spike-test">Spike Test</h5>

<h5 id="statistical-test">Statistical test</h5>

<h5 id="baseline-offset-test">Baseline Offset Test</h5>

<h5 id="erroneous-depth-range-test">Erroneous depth range Test</h5>

<h3 id="43-examples-of-qc-tests-applications">4.3 Examples of QC Tests Applications</h3>

<h2 id="references">References</h2>

<ol>
  <li><a href="https://doi.org/10.25923/vpsx-dc82">U.S. Integrated Ocean Observing System, 2021. Manual for Real-Time Quality Control of Water Level Data Version 2.1: A Guide to Quality Control and Quality Assurance of Water Level Observations. 47 pp.</a></li>
  <li><a href="ftp://ftp.library.noaa.gov/noaa_documents.lib/NWS/NWS_TSP_88-21-R2.pdf">NWS Techniques Specification Package (TSP) 88-21-R2 (1994)</a></li>
  <li><a href="https://www.maxbotix.com/documents/HRXL-MaxSonar-WR_Datasheet.pdf">Maxbotix HRXl-MaxSonar -WR Datasheet</a></li>
  <li><a href="https://www1.nyc.gov/html/dot/downloads/pdf/nyc-dot-traffic-signal-standard-drawings.pdf">New York City Department of Transportation Traffic Signal Standard Drawings</a></li>
  <li><a href="https://www.dot.ny.gov/main/business-center/engineering/specifications/busi-e-standards-usc/usc-repository/2017_9_stdsht_usc_book%204.pdf">New York State Standard Sheets</a></li>
  <li></li>
</ol>
:ET